<html>
  <head>
    <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <link rel="stylesheet" type="text/css" href="http://bootswatch.com/flatly/bootstrap.min.css">
    <link href="https://d1ic07fwm32hlr.cloudfront.net/images/favicon.ico" rel="shortcut icon" type="image/vnd.microsoft.icon">
  </head>
  <body>
  <div class="container">
  <div class="row">
  <div class="col-xs-6">
    <h1>O Online IDE</h1>
    <p>This is an IDE for the <a href="http://o.readthedocs.org/">O programming language</a>. 
    O and this site were made by <a href="https://github.com/phase">Phase</a>!</p>
    <br/>
    <p id="byteCount">0 bytes and 0 chars long.</p>
    <form id="o" action="" method="post">
      <fieldset>
        <input type="submit" value="Run!">
       </fieldset>
    </form>
    <p>Code</p>
    <textarea rows="4" cols="50" name="code" id="code" form="o">${CODE}</textarea>
    <p>Input (each line is a different input)</p>
    <textarea rows="4" cols="50" name="input" id="input" form="o">${INPUT}</textarea>
    <br/>
    <p>Error: <br/><b>${ERROR}</b></p>
    <br/>
    <input id = "permalink" type="submit" value="Permalink"/>
  </div>
  <div class="col-xs-6">
    <h3>Utilities</h3>
    <p>These are some utilities that can be used when coding in O.</p>
    <button id="util.genuni" onclick="genUni()">Generate Unicode</button>
  </div>
  </div>
  </div>
    <script>
    function genUni(){
        var code = prompt("Generate Unicode Character:");
        $('#code').val($('#code').val() + String.fromCharCode(parseInt(code)));
    };
    function getByteCount(s) {
      var count = 0, stringLength = s.length, i;
      s = String(s || "");
      for(i = 0; i < stringLength; i++){
        var partCount = encodeURI(s[i]).split("%").length;
        count += partCount == 1 ? 1 : partCount - 1;
      }
      return count;
    }
    function updateByteCount() {
      var c = $('#code').val();
      var byteCount = getByteCount(c);
      var charCount = c.length;
      var s = byteCount + " bytes and " + charCount + " chars long.";
      $('#byteCount').html(s);
    }
    updateByteCount();
    $(document).ready(function() {
      $("#permalink").click(function(){
        var code = $.param({code: $('#code').val(), input: $('#input').val()});
        prompt("Permalink:", "http://" + window.location.hostname + "/link/" + code);
        window.location.pathname = "/link/" + code;
      });
      $('#code').on('input propertychange paste', function() {
        updateByteCount();
      });
    });
    </script>
  </body>
</html>